-- Create schema
CREATE SCHEMA IF NOT EXISTS cafe;
SET search_path TO cafe;

-- Customers table
CREATE TABLE IF NOT EXISTS customers 
  (customer_id INT PRIMARY KEY,
  customer_name TEXT NOT NULL,
  segment TEXT,
  city TEXT);

-- Products table
CREATE TABLE IF NOT EXISTS products 
  (product_id INT PRIMARY KEY,
  product_name TEXT NOT NULL,
  category TEXT NOT NULL,
  unit_price NUMERIC(8,2) NOT NULL);

-- Orders table
CREATE TABLE IF NOT EXISTS orders 
  (order_id INT PRIMARY KEY,
  order_date DATE NOT NULL,
  customer_id INT NOT NULL REFERENCES customers(customer_id));

-- Order items table
CREATE TABLE IF NOT EXISTS order_items 
  (order_item_id INT PRIMARY KEY,
  order_id INT NOT NULL REFERENCES orders(order_id) ON DELETE CASCADE,
  product_id INT NOT NULL REFERENCES products(product_id),
  quantity INT NOT NULL,
  discount NUMERIC(4,2) NOT NULL,
  unit_price_for_calc NUMERIC(8,2) NOT NULL,
  line_amount NUMERIC(10,2) NOT NULL);
